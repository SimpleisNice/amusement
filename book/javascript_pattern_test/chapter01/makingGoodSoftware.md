# 1장 좋은 소프트웨어 만들기

## 목차

### 1.1 바르게 시작하는 코드 작성하기
### 1.2 바르게 유지되는 코드 작성하기
### 1.3 정리하기

---

## **1.1 바르게 시작하는 코드 작성하기**
> 신기할 것이 하나도 없습니다. 그저 제떼 제 건반을 짚으면 악기가 자신을 연주할 뿐입니다. [요한 제바스티안 바흐]

### **1.1.1 자바스크립트 특성을 완벽히 섭렵하라**

자바스크립트 함수는 다른 함수 내부에 중첩될 수 있으며, 이는 스코프를 다스리는 중요한 수단

자바스크립트 함수는 메서드/프로퍼티를 지닌 객체로, 다른 언어의 함수보다 훨씬 유연하고 강력

자바스크립트에서 객체 지향적 함수 오버로딩 개념은 함수의 argumnets 를 보고 여기에 뭔가 맞추는 행위

덕 타이핑을 잘 활용하면, 적은 코드로도 객체를 폭 넓게 다룰 수 있다.

클로저는 자바스크립트의 정말 강력한 설계 요소다. 모든 함수는 클로저다.

자바스크립트에서 this 는 설계 관점에서 절호의 기회가 될 수 있다. 잘 써먹도록 하자!

자바스크립트는 싱글 스레드로 움직인다.

### **1.1.2 대규모 시스템에서 자바스크립트 함정을 피하라**

스크립트는 모듈이 아니다.

스코프는 중첩 함수로 다스린다.
- 자바스크립트는 클래스가 없지만, 함수를 중첩하여 코드를 계층화할 수 있다.
- 이를 통해 개발자는 원하는 것을 찾는 데 도움이 될 뿐만 아니라 프로그램에서 변수/함수의 스코프를 최소화할 수 있다.

규약을 지켜 코딩한다.
- 대규모 시스템을 잘 꾸려 나가려면 될 수 있는 한 작게 만들어야 효과적이다.
- 자바스크립트는 간이 고루 잘 밴 덕 타이핑의 기상천외한 유연성 덕분에 적은 코드로도 많은 일을 할 수 있다.
- 함수 인자에 특정한 조건이 있다면 그 값을 꼭 검증해야 한다.

### **1.1.3 소프트웨어 공학 원칙을 적용하라**

SOLID 원칙
- 객체 지향 설계 원칙
- Single Responsibility Principle(단일 책임 원칙)
  - 모든 클래스(자바스크립트 함수)는 반드시 한 가지 변경 사유가 있어야 한다.
- Open/Closed Principle(개방/폐쇄 원칙)
  - 모든 소프트웨어 개체는 확장 가능은 열어 두되 수정 가능성은 닫아야 한다.
  - 즉, 어떤 경우라도 실행 코드를 변경하지 말고, 어떻게든 (상속 등의 방법으로) 재사용하고 확장하라는 뜻
- Liskov Substitution Principle(리스코프 치환 원칙)
  - 자료 추상화와 계층화(Data Abstraction and Hierarchy.)
  - 어떤 타입에서 파생된 타입의 객체가 있다면 이 타입을 사용하는 코드는 변경하지 말아야 한다.
  - 다시 말해, 한 객체를 다른 객체에서 파생하더라도 그 기본 로직이 변경되어서는 안 된다는 뜻.
  - 쉽게 말하면, 우리가 작성 중인 함수가 기반 클래스로 하는 일과 서브 클래스로 하는 일이 다르면 이 원칙을 어긴 셈
  - 서로 파생 관계가 없는 타입 간에는 적용되지 않는다.
- Interface Segregation Principle(인터페이스 분리 원칙)
  - 인터페이스란 클래스에서 어떤 기능을 구현하지 않고(명칭, 파라미터, 반환 타입을) 서술만 한 코드 조각이다(C++, 자바와 같은 언어 기준)
  - 기능이 많은 인터페이스는 더 작게 응축시킨 조각으로 나누어야 한다는 발상
  - 인터페이스 사용부(consumer)는 뚱뚱한 전체가 아니라 아주 작은 인터페이스 하나만 바라보면 된다.
  - 물론 모듈 간 연결 폭은 최소화하는 방향으로 가야함
  - 통신 채널을 줄이는 건 덩치 큰 자바스크립트 시스템의 중요한 관리 포인트
  - 자바스크립트에서는 인터페이스 분리 원칙의 정신을 실현하려면 함수가 기대하는 인자가 무엇인지 명확히 하고 그 기대치를 최소화해야 한다.
- Dependency Inversion Principle(의존성 역전 원칙)
  - 해당 원칙도 인터페이스와 관련이 있다.
  - 로버트 마틴은 "상위 수준 모듈은 하위 수준 모듈에 의존해서는 안 되며 이 둘은 추상화에 의존해야 한다."라고 말했다.


DRY 원칙
- 반복하지 마라!!!(Don't Repeat Yourself)
- 모든 지식 조각은 딱 한 번만 나와야 한다.
- DRY 한 코드로 만드는 과정에 의존성 주입과 단일 책임 문제가 개입된다.
- DRY 함은 여타 언어와 비교했을 때 자바스크립트에서 특별히 중요하다.

## **1.2 바르게 유지되는 코드 작성하기**
아무리 업무 요건을 정확하게 프로그래밍해도 유지 보수한 지 5년 정도 지나면 개발팀에서 수군대기 시작할 것이다.

### **1.2.1 단위 테스트는 미래에 대비한 투자다**
단위 테스트(unit test)
- 단위 테스트는 시간이 흐르면서 아무리 큰 변화의 소용돌이 속에 빠져도 완벽한 프로그램을 만들 수 있게 한다.
- 단위(unit)란 특정 조건에서 어떻게 작동해야 할지 정의한 것이다. 언제나 그런 것은 아니지만, 대개 함수로 표현한다.
- 단위 테스트 본체에 작성한 코드는 준비(arrange), 실행(act), 단언(assert)의 패턴을 따른다.
  - 첫째, 테스트 준비: 단위를 실행할 조건을 확실히 정하고, 의존성 및 함수 입력 데이터를 설정한다.
  - 둘째, 단위를 실행하여 테스트: 예를 들어 단위가 함수면 준비 단계에서 미리 설정한 입력값을 함수에 넘겨 실행한다.
  - 마지막, 테스트 단언: 미리 정한 조건에 따라 예상대로 단위가 작동하는지 확인한다. 단위가 함수인 테스트라면 예상한 값을 반환하는지 조사하면된다.

전체 단위 테스트 꾸러미(test suite)를 작성하는 데 든 시간과 노력은 앞으로 프로그램이 직면할 갖가지 변화에 대처하기 위한 보험이자, 안정적인 애플리케이션 유지에 꼭 필요한 최소한의 투자라고 할 수 있다.

단위 테스트가 실패한다는 것은 어떤 변화로 인해 기존 프로그램의 기능이 바뀌었으니 실패를 유발한 이 변화를 자세히 들여다보아야 한다는 사실을 일깨워주는 적색 신호등이다.

### **1.2.2 테스트 주도 개발을 실천하라**
테스트 주도 개발(Test-Driven Development, TDD)은 처음부터 프로그램을 제대로 작성했는지 확실히 보장한다.

TDD 에서는 애플리케이션 코드를 짜기 전에 이 코드가 통과해야 할 단위 테스트를 먼저 작성한다.

마치 애플리케이션을 개발하듯, 전체 단위 테스트 꾸러미를 만들어가는 TDD 방식을 따르면 단위 정의와 인터페이스 설계에 도움이 많이된다.

TDD 를 실천하는 개발자는 애플리케이션에 어떤 변화가 생길 때마다 다음 단계를 밟는다.
- 여기서 변화란 완전히 새로운 기능을 추가하거나 기존 시스템을 고치고 버그를 잡는 일이다.
- 1단계, 완벽히 변경하면 성공하나 그렇게 되기 전까지는 반드시 실패하는 단위 테스트를 작성한다.
- 2단계, 테스트가 성공할 수 있을 만큼만 최소한으로 코딩한다.
- 3단계, 애플리케이션 코드를 리팩토링하며 중복을 제거한다.
- 위 3단계를 흔히 적색(red), 녹색(green), 리팩터(refactor) 라고 줄여서 말하며, 적색과 녹색은 각각 새 단위 테스트의 실패와 성공 상태를 가리킨다.

TDD 에서 가장 중요한 건 테스트를 충족할 코드를 만들기 전에 테스트를 먼저 작성한다는 사실이다.

### **1.2.3 테스트하기 쉬운 코드로 다듬어라**
테스트하기 쉬운 코드를 작성하려면 가장 중요한 단계는 관심사를 적절히 분리하는 일이다.(단일 책임 원칙을 참고)

서로 다른 관심사는 작고 간단한 모듈로 나누어 만들면 코드 작성과 테스트, 그리고 이해가 쉽다.

이런 식으로 만든 코드는 장기적으로 별 탈 없이 작동할 가능성이 크다.

TDD 가 개발 속도를 늦출 것으로 생각하는 사람도 있으리라.
- 관심사를 제대로 분리하지 않은 채 코딩하고 테스트를 작성하는 식으로 진행하면 정말 늦어지게 될 것이라 확신한다.

무수한 실수의 늪에 빠져 허우적거리기 전에 단위 테스트가 실수를 가능한 빨리 발견하는 길이가는 진리

적색-녹색-리팩터 과정을 반복하며 작은 코드를 개발하다 보면 점점 속도가 붙게 된다.
- 첫째, 작은 코드는 대개 간단하고 실수할 가능성이 작아 디버깅 시간을 상당히 줄일 수 있다.
- 둘째, 테스트로 코드를 완전히 커버하니 리팩토링을 하더라도 무서울 게 없다. 따라서 코드를 DRY 하게 유지하여 코드베이스에 오류 발생 여지를 줄이고 규모를 작게 가져갈 수 있다.
  - DRY 는 결국 재사용을 의미하며, 재사용 가능한 코드는 시간을 절약한다.

## **1.3 정리하기**
자바스크립트는 개발자에게 훌륭한 설계 기회다.

자바스크립트의 사용 범위가 대규모 시스템으로 확대되면서 언어 자체의 거친 부분을 잘 다루는 일이 아주 중요해졌다.

단위 테스트는 장기적인 관점에서 안정된 애플리케이션을 만들기 위한 최선의 투자다

테스트 주도 개발을 실천하면 여러가지 혜택이 있다.
- 장기적인 믿음성을 보장하는 단위 테스트 꾸러미를 구축
- 애플리케이션 객체에 정확한 인터페이스를 설계할 때 도움이 된다.
- 단위 테스트를 통해 코드를 더 빨리 개발할 수 있다.

테스트성을 높이려면 관심사를 분리하는 일에 집중하고 단일 책임 원칙이나 의존성 주입 같은 소프트웨어 공학 원칙을 잘 써먹는게 중요하다